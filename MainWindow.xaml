<Window x:Class="Net8_Desktop_InsecureApp_Plus.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Net8_Desktop_InsecureApp_Plus"
        mc:Ignorable="d"
        Title="Vulnerable Application - Security Testing Tool" Height="600" Width="1000">
    <Grid>
        <TabControl>
            <!-- SQL & NoSQL Injection Tab -->
            <TabItem Header="SQL/NoSQL Injection">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <GroupBox Header="SQL Injection Test" Grid.Column="0" Margin="5">
                        <StackPanel Margin="10">
                            <Label Content="Username:"/>
                            <TextBox x:Name="txtUsername" Width="200" HorizontalAlignment="Left"/>
                            <Label Content="Password:"/>
                            <TextBox x:Name="txtPassword" Width="200" HorizontalAlignment="Left"/>
                            <Button x:Name="btnLogin" Content="Login (Tests Multiple Injections)" Width="200" 
                                    HorizontalAlignment="Left" Margin="0,10,0,0" Click="btnLogin_Click"/>
                            <TextBlock Text="Tests: SQL, MongoDB injection, Auth bypass, Plain text storage" 
                                       Foreground="Red" FontSize="10" Margin="0,5,0,0" TextWrapping="Wrap"/>
                        </StackPanel>
                    </GroupBox>

                    <GroupBox Header="Database Search" Grid.Column="1" Margin="5">
                        <StackPanel Margin="10">
                            <Label Content="Search Term:"/>
                            <TextBox x:Name="txtSearchTerm" Width="200" HorizontalAlignment="Left"/>
                            <Button x:Name="btnDatabaseSearch" Content="Search Databases" Width="150" 
                                    HorizontalAlignment="Left" Margin="0,10,0,0" Click="btnDatabaseSearch_Click"/>
                            <TextBlock Text="Tests: PostgreSQL injection" 
                                       Foreground="Red" FontSize="10" Margin="0,5,0,0"/>
                        </StackPanel>
                    </GroupBox>
                </Grid>
            </TabItem>

            <!-- Command Injection Tab -->
            <TabItem Header="Command/Code Injection">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <GroupBox Header="OS Command Injection" Grid.Column="0" Margin="5">
                        <StackPanel Margin="10">
                            <Label Content="Enter Command:"/>
                            <TextBox x:Name="txtCommand" Width="300" HorizontalAlignment="Left"/>
                            <Button x:Name="btnExecute" Content="Execute Command" Width="150" 
                                    HorizontalAlignment="Left" Margin="0,10,0,0" Click="btnExecute_Click"/>
                            <TextBlock Text="Tests: CMD, PowerShell injection, Integer overflow" 
                                       Foreground="Red" FontSize="10" Margin="0,5,0,0"/>
                        </StackPanel>
                    </GroupBox>

                    <GroupBox Header="Code Injection" Grid.Column="1" Margin="5">
                        <StackPanel Margin="10">
                            <Label Content="C# Expression:"/>
                            <TextBox x:Name="txtExpression" Width="300" HorizontalAlignment="Left"/>
                            <Button x:Name="btnEvaluate" Content="Evaluate Expression" Width="150" 
                                    HorizontalAlignment="Left" Margin="0,10,0,0" Click="btnEvaluate_Click"/>
                            <TextBlock Text="Tests: Dynamic code execution, Race conditions" 
                                       Foreground="Red" FontSize="10" Margin="0,5,0,0"/>
                        </StackPanel>
                    </GroupBox>
                </Grid>
            </TabItem>

            <!-- XXE & Deserialization Tab -->
            <TabItem Header="XXE/Deserialization">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <GroupBox Header="XXE Injection" Grid.Column="0" Margin="5">
                        <StackPanel Margin="10">
                            <Label Content="XML Input:"/>
                            <TextBox x:Name="txtXmlInput" Width="350" Height="100" HorizontalAlignment="Left" 
                                     TextWrapping="Wrap" AcceptsReturn="True"/>
                            <Button x:Name="btnParseXML" Content="Parse XML" Width="100" HorizontalAlignment="Left" 
                                    Margin="0,10,0,0" Click="btnParseXML_Click"/>
                            <TextBlock Text="Tests: XXE, Unrestricted file upload" 
                                       Foreground="Red" FontSize="10" Margin="0,5,0,0"/>
                        </StackPanel>
                    </GroupBox>

                    <GroupBox Header="Unsafe Deserialization" Grid.Column="1" Margin="5">
                        <StackPanel Margin="10">
                            <Label Content="Base64 Serialized Data:"/>
                            <TextBox x:Name="txtSerializedData" Width="350" Height="100" HorizontalAlignment="Left" 
                                     TextWrapping="Wrap"/>
                            <Button x:Name="btnDeserialize" Content="Deserialize" Width="100" HorizontalAlignment="Left" 
                                    Margin="0,10,0,0" Click="btnDeserialize_Click"/>
                            <TextBlock Text="Tests: BinaryFormatter, Weak API key generation" 
                                       Foreground="Red" FontSize="10" Margin="0,5,0,0"/>
                        </StackPanel>
                    </GroupBox>
                </Grid>
            </TabItem>

            <!-- Path Traversal & SSRF Tab -->
            <TabItem Header="Path Traversal/SSRF">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <GroupBox Header="Path Traversal" Grid.Column="0" Margin="5">
                        <StackPanel Margin="10">
                            <Label Content="File Name:"/>
                            <TextBox x:Name="txtFileName" Width="300" HorizontalAlignment="Left"/>
                            <Button x:Name="btnReadFile" Content="Read File" Width="100" HorizontalAlignment="Left" 
                                    Margin="0,10,0,0" Click="btnReadFile_Click"/>
                            <TextBox x:Name="txtFileContent" Width="350" Height="120" HorizontalAlignment="Left" 
                                     Margin="0,10,0,0" TextWrapping="Wrap" IsReadOnly="True" 
                                     ScrollViewer.VerticalScrollBarVisibility="Auto"/>
                            <TextBlock Text="Tests: Path traversal, Admin bypass, Race conditions" 
                                       Foreground="Red" FontSize="10" Margin="0,5,0,0"/>
                        </StackPanel>
                    </GroupBox>

                    <GroupBox Header="SSRF" Grid.Column="1" Margin="5">
                        <StackPanel Margin="10">
                            <Label Content="URL:"/>
                            <TextBox x:Name="txtUrl" Width="350" HorizontalAlignment="Left"/>
                            <Button x:Name="btnFetchUrl" Content="Fetch URL" Width="100" HorizontalAlignment="Left" 
                                    Margin="0,10,0,0" Click="btnFetchUrl_Click"/>
                            <TextBox x:Name="txtResult" Width="350" Height="120" HorizontalAlignment="Left" 
                                     Margin="0,10,0,0" TextWrapping="Wrap" IsReadOnly="True"
                                     ScrollViewer.VerticalScrollBarVisibility="Auto"/>
                            <TextBlock Text="Tests: SSRF, Clear text transmission" 
                                       Foreground="Red" FontSize="10" Margin="0,5,0,0"/>
                        </StackPanel>
                    </GroupBox>
                </Grid>
            </TabItem>

            <!-- XSS & HTML Tab -->
            <TabItem Header="XSS/HTML Injection">
                <StackPanel Margin="10">
                    <Label Content="HTML Input:"/>
                    <TextBox x:Name="txtHtmlInput" Width="500" Height="60" HorizontalAlignment="Left" 
                             TextWrapping="Wrap" AcceptsReturn="True"/>
                    <Button x:Name="btnDisplayHtml" Content="Display HTML (Unsafe)" Width="150" 
                            HorizontalAlignment="Left" Margin="0,10,0,0" Click="btnDisplayHtml_Click"/>
                    <WebBrowser x:Name="webBrowser" Width="500" Height="250" HorizontalAlignment="Left" 
                               Margin="0,10,0,0"/>
                    <TextBlock Text="Tests: XSS, Plain text API key storage" 
                               Foreground="Red" FontSize="10" Margin="0,5,0,0"/>
                </StackPanel>
            </TabItem>

            <!-- Authentication & Crypto Tab -->
            <TabItem Header="Auth/Crypto">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <GroupBox Header="Hardcoded Credentials" Grid.Column="0" Margin="5">
                        <StackPanel Margin="10">
                            <Label Content="Admin Password:"/>
                            <PasswordBox x:Name="txtAdminPassword" Width="200" HorizontalAlignment="Left"/>
                            <Button x:Name="btnValidateAdmin" Content="Validate Admin" Width="120" 
                                    HorizontalAlignment="Left" Margin="0,10,0,0" Click="btnValidateAdmin_Click"/>
                            <TextBlock Text="Tests: Hardcoded password, CSRF, Weak reset tokens" 
                                       Foreground="Red" FontSize="10" Margin="0,5,0,0" TextWrapping="Wrap"/>
                        </StackPanel>
                    </GroupBox>

                    <GroupBox Header="Crypto Operations" Grid.Column="1" Margin="5">
                        <StackPanel Margin="10">
                            <Label Content="Text to Encrypt:"/>
                            <TextBox x:Name="txtPlainText" Width="200" HorizontalAlignment="Left"/>
                            <Button x:Name="btnEncrypt" Content="Encrypt (Weak)" Width="120" 
                                    HorizontalAlignment="Left" Margin="0,10,0,0" Click="btnEncrypt_Click"/>
                            <TextBlock x:Name="txtEncrypted" TextWrapping="Wrap" Margin="0,10,0,0"/>
                            <TextBlock Text="Tests: MD5, ECB mode, Hardcoded keys" 
                                       Foreground="Red" FontSize="10" Margin="0,5,0,0"/>
                        </StackPanel>
                    </GroupBox>
                </Grid>
            </TabItem>

            <!-- File Operations Tab -->
            <TabItem Header="File Operations">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <GroupBox Header="File Save" Grid.Column="0" Margin="5">
                        <StackPanel Margin="10">
                            <Label Content="Save File Name:"/>
                            <TextBox x:Name="txtSaveFileName" Width="300" HorizontalAlignment="Left"/>
                            <Label Content="Content:"/>
                            <TextBox x:Name="txtSaveContent" Width="350" Height="80" HorizontalAlignment="Left" 
                                     TextWrapping="Wrap" AcceptsReturn="True"/>
                            <Button x:Name="btnSaveFile" Content="Save File" Width="100" HorizontalAlignment="Left" 
                                    Margin="0,10,0,0" Click="btnSaveFile_Click"/>
                            <TextBlock Text="Tests: Path injection, Credit card storage, Unrestricted upload" 
                                       Foreground="Red" FontSize="10" Margin="0,5,0,0" TextWrapping="Wrap"/>
                        </StackPanel>
                    </GroupBox>

                    <GroupBox Header="File Upload" Grid.Column="1" Margin="5">
                        <StackPanel Margin="10">
                            <Label Content="Upload File:"/>
                            <Button x:Name="btnBrowseFile" Content="Browse..." Width="100" 
                                    HorizontalAlignment="Left" Click="btnBrowseFile_Click"/>
                            <TextBlock x:Name="txtSelectedFile" Margin="0,5,0,0"/>
                            <Button x:Name="btnUploadFile" Content="Upload File" Width="100" 
                                    HorizontalAlignment="Left" Margin="0,10,0,0" Click="btnUploadFile_Click"/>
                            <TextBlock Text="Tests: Unrestricted file type upload, Auto-execution" 
                                       Foreground="Red" FontSize="10" Margin="0,5,0,0" TextWrapping="Wrap"/>
                        </StackPanel>
                    </GroupBox>
                </Grid>
            </TabItem>

            <!-- Network & HTTPS Tab -->
            <TabItem Header="Network/HTTPS">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <GroupBox Header="Certificate Bypass" Grid.Column="0" Margin="5">
                        <StackPanel Margin="10">
                            <Label Content="HTTPS Request Demo"/>
                            <Button x:Name="btnHttpsRequest" Content="Make Insecure HTTPS Request" Width="200" 
                                    HorizontalAlignment="Left" Margin="0,10,0,0" Click="btnHttpsRequest_Click"/>
                            <TextBlock Text="Tests: Certificate validation bypass, TLS downgrade" 
                                       Foreground="Red" FontSize="10" Margin="0,5,0,0"/>
                        </StackPanel>
                    </GroupBox>

                    <GroupBox Header="Admin Operations" Grid.Column="1" Margin="5">
                        <StackPanel Margin="10">
                            <Button x:Name="btnDeleteUsers" Content="Delete All Users" Width="150" 
                                    HorizontalAlignment="Left" Margin="0,5,0,0" Click="btnDeleteUsers_Click"/>
                            <Button x:Name="btnBackupDB" Content="Backup Database" Width="150" 
                                    HorizontalAlignment="Left" Margin="0,5,0,0" Click="btnBackupDB_Click"/>
                            <Button x:Name="btnAccessAdmin" Content="Access Admin Panel" Width="150" 
                                    HorizontalAlignment="Left" Margin="0,5,0,0" Click="btnAccessAdmin_Click"/>
                            <TextBlock Text="Tests: Missing authentication, Critical operations" 
                                       Foreground="Red" FontSize="10" Margin="0,5,0,0"/>
                        </StackPanel>
                    </GroupBox>
                </Grid>
            </TabItem>

            <!-- Status Tab -->
            <TabItem Header="Status/Logs">
                <StackPanel Margin="10">
                    <Label Content="Application Status and Logs:" FontWeight="Bold"/>
                    <TextBox x:Name="txtStatus" Width="700" Height="350" HorizontalAlignment="Left" 
                             TextWrapping="Wrap" IsReadOnly="True" 
                             ScrollViewer.VerticalScrollBarVisibility="Auto"
                             ScrollViewer.HorizontalScrollBarVisibility="Auto"/>
                    <Button x:Name="btnClearStatus" Content="Clear Status" Width="100" 
                            HorizontalAlignment="Left" Margin="0,10,0,0" Click="btnClearStatus_Click"/>
                </StackPanel>
            </TabItem>
        </TabControl>
    </Grid>
</Window>